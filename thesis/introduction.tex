%%%%%% Introduction %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%{{{
\chapter{Introduction}\label{sec:intro}

With the latest releases of Microarchitectural attacks like
Meltdown~\cite{meltdown} and Spectre~\cite{spectre}, the topic of flaws in
hardware implementations became known to the general public. Many media outlets
reported on these issues of modern CPUs. Where it was mostly vendors of
x86-architecture CPUs like Intel or AMD, also ARM, and with it, most mobile
devices are affected by such flaws.

Issues like these show that these vendors have set performance above security by
neglecting quality management and testing. The demand for better releases of
hardware is rising all the time, and not only vendors of CPUs are affected by
this demand. Another field of silicon chip design ran into a similar problem in
the past, namely DRAM chip vendors.  

In 2015, Kim~\etal~\cite{rowhammergeneral} released their paper ``RowHammer'',
showing how specially crafted memory access routines can cause bits in DRAM
chips to flip, without accessing them directly. This work showed how the demand
for higher memory density caused faults where interfering voltages and leaking
currents to influence other memory storage cells. While at first, this was just
seen as a stability issue, Google\textquotesingle s Project Zero showed how
Rowhammer can be used for privilege escalation and sandbox
escapes~\cite{projectzerorow}. With reports like this, the interest in
researching the field of Rowhammer increased. Gruss~\etal~\cite{rowhammerjs}
showed that it is not only possible to target systems by executing native code,
but also that Rowhammer can be triggered by using JavaScript. Van der
Veen~\etal\cite{drammer} published their work named ``Drammer'', where they show
how not only desktop computers are affected by the Rowhammer bug, but also
mobile devices. Earlier this year, Gruss~\etal~\cite{nethammer}, released a way
to trigger bitflips by only sending specially-crafted network requests.
Publications like these show that Rowhammer is an active research topic, where
still new findings come up.

\todo{Insert Research Question here}

Testing and debugging were always a significant part of software technology, and
with rising sizes of projects and an increasing number of old code bases, it is
more vital than ever. Not only developers are putting much work into these
topics but also researchers releasing new ways of testing regularly. With modern
approaches for testing like fuzzying, bug searching in unknown code got more
successful. Also, the field of proving software\textquotesingle s correctness
got much attention. With symbolic execution techniques, the possibility to prove
each software state on its own got more practical. The release of the open
source symbolic execution framework \texttt{angr}~\cite{angrpaper} made it
possible for a wide range of users to apply symbolic execution to programs. This
tool mostly gets used in testing, in combination with fuzzing, but also security
researchers use \texttt{angr} to find exploitable code segments and execution
paths.

Understanding what programs do, and how they are executed by the CPU, gets
harder with every improvement and change in hardware design. Instrumentation is
a technique to inject code to programs providing the possibility to collect
runtime information. With tools like Intel Pin~\cite{pintool} it is possible to
check changes to processor registers, log accessed memory and performance
measuring at machine code level.

\section{Goals and Motivation for the Thesis}

With our work, we want to increase the awareness about Rowhammer and making the
issue better known to the general public. We want to use the attention given to
microarchitectural attacks to improve the knowledge about other work in this
field. For Rowhammer, Gruss~\etal~\cite{flipinthewall} already showed that
current defences are not suitable. Attackers can still use bitflips to gain
privilege escalation or use them to do other things threatening the security of
users. We want to take this approach further to present an easy way to find
bitflips in programs which cause them to behave differently. With our work, we
want to increase the impact of Rowhammer, supporting the research of better
countermeasures and forcing vendors to built secure and higher quality DRAM
chips again.

With the knowledge gained from already released Rowhammer attacks and the
knowledge gained from modern testing approaches, like fuzzing, we want to
combine these fields to get the best possible outcome for finding feasible
bitflips.

Whereas securing systems is something wanted by most users and vendors, we want
to show that without flawless hardware components security claims on other
levels are worthless. We want to push the desire of secure code and operating
systems down to hardware layers to have users, and researchers care as much
about security in this field as they already do for their running programs and
network connections.

\section{Contributions of this Work}

Our contribution to the field of microarchitectural attacks and Rowhammer is
providing a practical analysis of real-world applications and how bitflips can
affect them. We present a framework which can be used to find bitflips changing
a program\textquotesingle s behaviour to a pre-defined outcome. The structure of
the framework is designed to be extensible and adaptable for multiple purposes.

We apply our tool to real-world applications to show the impact bitflips could
have on users of personal computers. On one hand, we show how privilege
escalation bitflips can be found in the \texttt{sudo} program. We show bits,
which when flipped, allow us to skip the password check. On the other hand, we
also analyse the popular \texttt{nginx} web server. For this application, we
show bitflips which permit an attacker to bypass HTTP authentication measures.
We present results for these two applications and if there exist bits, which
when flipped, allow us to achieve our set outcome. Besides analysing the bits
inside the program\textquotesingle s executable, we also examine any dynamically
loaded library it uses. By that, we also cover possibilities where external
functions could change the application\textquotesingle s outcome.

In addition to that, we look at possible cryptographic vulnerabilities
introduced by bitflips. As a basis, we took the work by
BÃ¶ck~\etal~\cite{gcmnonceattack}, who showed how web servers were misusing
nonces when using AES-GCM. We build on their approach to bypass the fixes
applied by server software to re-introduce this nonce misusage via bitflips.
Here we look at the current implementation of AES-GCM in the TLS library
OpenSSL, used by most web servers. We show that nonce misusage can be
reintroduced by bitflips and give a probability for them.

\section{Outline of this Work}

We present this work separated into different chapters. We start with a general
overview of topics in this field. Beginning with describing how programs get
executed on modern computers and how operating systems handle applications. For
this, we describe the general design of executables on Unix-like systems, as we
discuss the executable and linkable format (ELF) in more detail.

As ELF files hold machine code executed by CPUs, and our work relies heavily on
how machine code is built, we discuss the design of instructions in modern
CPU architectures.  We then go on and look at different testing techniques in
software development, where we compare and describe several options and check
their advantages and disadvantages. In particular, we work out details about
fuzzing, symbolic execution and instrumentation. For our work, we try to change
the behaviour of programs by modifying their execution path, most of the time
this behaviour is changed to gain improved privileges. Therefore, we discuss the
permission model used by common Unix-based operating systems.

We also look at details of how permission switches work on these systems,
especially of how the \texttt{setuid} property of executables works. For
permission separation and testing purposes we also take a look at the
\texttt{chroot} environment provided by most Unix-like operating systems. We
do not only target behaviour changes to gain a higher privilege but also target
changes to bypass permission checks.

Moreover, besides local attacks, we also look at remote possibilities. We
describe the networking and security principles used by most computers and
servers. We look at common web servers, TLS libraries and how they provide
security for users. As our work targets cryptographic implementations, we take
a detailed look at the advanced encryption standard (AES) and a variant of it
using Galois/counter mode (AES-GCM).

Our work relies heavily on Rowhammer, which is a software-based
microarchitectural attack. We take a look at these attacks in general and give
an overview of state of the art attacks using similar techniques. As timing
plays a vital role in exploiting side-channels in this area, we describe precise
timing measurement methods. We look at recent cache attacks and the impact
those have on modern systems. We close our background overview with a detailed
description of the Rowhammer bug.

We continue with describing our distribution. This is split into two parts, one
being our testing of bitflips in ELF files and the other being attacks against
cryptographic functions during runtime. We start with the ELF analysis and
describe what impact a single bitflip can have to the execution paths of a
program. We go on with outlining possibilities to find bitflips which would
change the behaviour in a manner so that it benefits an attacker. We describe
the design of our automated bitflip-search framework and how we applied it to
real-world applications. We resume by showing the results of our tests for
the applications of \texttt{sudo} and \texttt{nginx}. We also mention how we
would apply these bitflips to a system by using the Rowhammer bug.

In the second part of our contribution we describe the influence of bitflips on
cryptographic implementations, we discuss the problems of nonce misuse and how
this problem could be introduced to AES-GCM implemented in OpenSSL with
bitflips. We give numbers for a likelihood of such a nonce-misuse introduced by
a single bit flip. We show how we tested this issue in a practical setup with a
simple web server using the OpenSSL library.

We go on with looking at countermeasures for issues in the field of
microarchitectural attacks. We look at possible ways to prevent cache attacks
and Rowhammer. We also line out ways of reducing the impact of our tests on
real-world setups. We close this section by describing how general system
security could be improved.

As microarchitectural attacks are an on-going and growing research field, we
also look at possible future works. We describe a possible future of these
attacks in general, how open source architectures could help to prevent some of
them. We also talk about a possible attribution of machine learning to help to
find new attack vectors. We also find possibilities to improve the impact of
Rowhammer, by looking at new attacks coming by applying it to further
implementations of cryptographic algorithms. In the end, we talk about how our
framework could be helpful for future work and how it can be used in various
testing and research environments with just small code changes.

We close our thesis by giving a conclusion describing our results, provide a
summary of the outcome of our work and point out again how vital secure hardware
is as a basis for secure systems. Therefore we recommend hardware vendors to
improve their quality checks and by this improve general security for users.
%}}}

%% vim:foldmethod=expr
%% vim:fde=getline(v\:lnum)=~'^%%%%\ .\\+'?'>1'\:'='
%%% Local Variables:
%%% mode: latex
%%% mode: auto-fill
%%% mode: flyspell
%%% eval: (ispell-change-dictionary "en_US")
%%% TeX-master: "main"
%%% End:
